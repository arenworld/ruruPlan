<!DOCTYPE html>
<html  class="responsive-login-page" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>회원가입 폼</title>
    <link rel="stylesheet" href="/css/rurustyle.css" />
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
    />
    <script src="/javascript/member/joinForm.js"></script>
    <script src="/js/jquery-3.4.1.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#memberId').keyup(idConfirm);
            $('#nickname').keyup(nicknameConfirm);
            $('#pwConfirm').keyup(pwConfirm);
            $('#emCertification').click(emCertification);
        });

        function idConfirm(){
            let id = $(this).val();
            if (id.length < 6 || id.length > 15) {
                $('#idmsg').css('color', 'red');
                $('#idmsg').html('아이디를 6~15글자로 입력해 주세요');
            } else {
                $.ajax({
                    url: 'idDuplicate',
                    type: 'post',
                    data: {id: id},
                    success: function (res) {
                        if (res) {
                            $('#idmsg').css('color', 'red');
                            $('#idmsg').html("이미 사용중인 ID입니다");
                        } else {
                            $('#idmsg').css('color', 'blue');
                            $('#idmsg').html("사용가능한 ID입니다.");
                        }
                    },
                    error: function () {
                        alert('에러');
                    }
                });
            }
        }

        function nicknameConfirm(){
            let nickname = $(this).val();
            if (nickname.length < 1 || nickname.length > 10) {
                $('#nicknamemsg').css('color', 'red');
                $('#nicknamemsg').html('닉네임을 1~10글자로 입력해 주세요');
            } else {
                $('#nicknamemsg').css('color', 'blue');
                $('#nicknamemsg').html('사용 가능한 닉네임입니다.');
            }
        }

        function pwConfirm(){
            let pwConfirm = $(this).val();
            let pw = $('#memberPw').val();

            console.log(pwConfirm, pw);

            if(pwConfirm == pw){
                $('#pwmsg').css('color', 'blue');
                $('#pwmsg').html("비밀번호 일치");
            } else {
                $('#pwmsg').css('color', 'red');
                $('#pwmsg').html("비밀번호가 일치하지 않습니다.");
            }
        }

        function emCertification(){
            let email = $('#email').val();

            $.ajax({
                url: '/send-verification-email',
                type: 'post',
                data: {email: email},
                success: function (res) {
                    if (res) {
                        $('#emailmsg').css('color', 'black');
                        $('#emailmsg').html("인증 번호가 전송되었습니다.");
                    }
                    alert("전송 성공했으나 뭔가 잘못됨")
                },
                error: function () {
                    $('#emailmsg').css('color', 'red');
                    $('#emailmsg').html("전송 실패");
                }
            });
        }
    </script>
</head>
<body class="responsive-login-page">
    <div class="logo-title">
        <img class="logo" src="images/화면 캡처 2024-09-01 125210.png" />
      <p>ソウルに触る</p>
    </div>
    <div class="responsive-frame">
        <main>
    <p class="main-title">会員登録</p>
<!--    &lt;!&ndash; 개잊정보 약관 &ndash;&gt;
    <div class="terms">
     <h2>dp Terms of Service</h2>
         <p class="small">개인정보 처리 약관 내용</p>
    </div>-->
    <!-- 회원가입 양식 -->
    <form class="login-form" th:action="@{/join}" method="post">
        <div class="input-group">
        <!--아이디-->
      <label for="memberId"  class="input-label">ID</label>
        <input type="text" name="memberId" id="memberId" placeholder="ID">
        <span id="idmsg" ></span>
        </div>
        <!-- 비밀번호 -->
        <div class="input-group">
        <label for="memberPw"  class="input-label">Password</label>
        <input type="password" name="memberPw" id="memberPw" placeholder="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;">
        </div>
        <!--비밀번호 확인-->
        <div class="input-group">
        <label for="pwConfirm" class="input-label">Password Confirm</label>
        <input type="password" id="pwConfirm">
            <span id="pwmsg"></span>
        </div>
        <!--닉네임-->
        <div class="input-group">
        <label for="nickname" class="input-label">Nickname</label>
        <input type="text" name="nickname" id="nickname" placeholder="Nickname">
            <span id="nicknamemsg"></span>
        </div>
        <!--연령대-->
        <div class="input-group">
        <label for="age" class="input-label">Age</label>
            <select id="age" name="age" ckass="input=select">
                <option value="">Age</option>
                <option value="10">10대</option>
                <option value="20">20대</option>
                <option value="30">30대</option>
                <option value="40">40대</option>
                <option value="50">50대</option>
                <option value="60">60대</option>
            </select>
        </div>
        <div class="input-group">
      <label for="email" class="input-label">Email</label>
        <input type="email" name="email" id="email" placeholder="Email">
        <input type="button" id="emCertification" value="認証">
            <span id="emailmsg"></span>
        </div>
        <div class="form-group last mb-4 check_input">
            <label for="memailconfirm" id="memailconfirmTxt">인증번호를 입력해주세요</label>
            <input type="text" class="form-control" id="memailconfirm">
        </div>
        <div class="box-clause-round">
            <div class="clause-item">
      <input type="checkbox" name="agree" id="agree">
     <label for="agree">I agree to the <i class="fa fa-arrow-left"  aria-hidden="true"></i><a class="agree" href="#">Terms of service</a></label>
            </div>
        </div>
                <div id="form-controls">
         <button type="submit">Sign Up</button>
     </div>
    </form>
</body>
</html>
